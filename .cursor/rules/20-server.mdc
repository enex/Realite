---
description: Server-side guidelines (Bun, ORPC, event store, projections)
globs:
  - server/**
  - shared/**
  - db/**
alwaysApply: false
---

- Use Bun to run scripts: `bun run <script>`
- ORPC
  - Define routes/handlers in `server/orpc.ts`
  - Clients use `client/orpc.ts`
  - Commands should auth+validate before emitting events
- Events and projections
  - Define new events in `server/events.ts`
  - Apply/store events via `server/eventsourcing.ts` / `server/pgEventStore.ts` / `server/es.ts`
  - Write read models in `server/projections.ts` using Drizzle; never mutate domain tables elsewhere
- DB utilities
  - Schema: `db/schema.ts`; migrations in `drizzle/`
  - Common: `bun run db:generate`, `bun run db:push`, `bun run db:studio`
- Docker
  - Build: `./scripts/build-docker.sh` or `docker build -t realite-server .`
  - Run: `docker-compose up`
